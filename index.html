<!DOCTYPE html>
<html>
    <head>
        <title>MAPEIA+: Sua nova maneira de interagir com a cidade</title>
        
        <style>
            /* ESTILOS DA PÁGINA (ORIGINAL + styles.css) */
            body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
                background-color: #f4f7f6;
                color: #333;
                margin: 0;
                padding: 0;
                line-height: 1.6;
            }

            p {
                margin-top: 0;
            }

            h1, h2, h3 {
                color: #C00000; /* MUDADO */
                margin-top: 0;
            }

            #Tagline, #login, #registro-form, #denuncia-container, .areas-container {
                max-width: 600px;
                margin: 30px auto;
            }

            #Tagline, #login, #registro-form, #denuncia-container {
                background-color: #ffffff;
                border: 1px solid #e0e0e0;
                border-radius: 8px;
                padding: 30px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            }

            #headerina {
                background-color: #C00000; /* MUDADO */
                color: white;
                padding: 15px 30px;
                font-weight: bold;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            }

            #Tagline {
                text-align: center;
            }

            #Tagline h1 {
                font-size: 2.5em;
                margin-bottom: 10px;
            }

            #Tagline h2 {
                font-size: 1.2em;
                color: #555;
                font-weight: 400;
            }

            form label {
                font-weight: bold;
                display: block;
                margin-bottom: 5px;
            }

            form label p {
                margin: 0;
            }

            input[type="text"],
            input[type="email"],
            input[type="password"],
            select,
            textarea {
                width: 100%;
                padding: 12px;
                margin-bottom: 15px;
                border: 1px solid #ccc;
                border-radius: 4px;
                box-sizing: border-box;
                font-size: 16px;
            }

            input:focus, select:focus, textarea:focus {
                border-color: #C00000; /* MUDADO */
                outline: none;
                box-shadow: 0 0 5px rgba(192, 0, 0, 0.3); /* MUDADO */
            }

            button {
                width: 100%;
                padding: 15px;
                border: none;
                border-radius: 4px;
                background-color: #C00000; /* MUDADO */
                color: white;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                transition: background-color 0.3s ease, transform 0.1s ease;
            }

            button:hover {
                background-color: #990000; /* MUDADO (vermelho mais escuro) */
                transform: translateY(-1px);
            }

            #btn-localizacao {
                background-color: #5cb85c;
                margin-bottom: 10px;
            }

            #btn-localizacao:hover {
                background-color: #4a9d4a;
            }

            #mensagem-login,
            #mensagem-registro,
            #mensagem-denuncia,
            #mensagem-localizacao {
                font-weight: bold;
                font-size: 1.1em;
                margin-top: 15px;
                text-align: center;
                padding: 10px;
                border-radius: 4px;
            }

            #mensagem-localizacao {
                background-color: #f0f0f0;
            }

            div[id="parent act"] h1 {
                text-align: center;
                color: #C00000; /* MUDADO */
                margin-top: 40px;
            }

            .areas-container {
                display: flex;
                justify-content: space-between;
                gap: 20px;
                max-width: 800px;
            }

            #act1, #act2, #act3 {
                flex: 1;
                background: #fff;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
                text-align: center;
                font-weight: bold;
                color: #C00000; /* MUDADO */
                border-bottom: 4px solid #C00000; /* MUDADO */
            }
            
            /* ESTILOS ORIGINAIS DO ARQUIVO HTML */
            #registro-form {
                margin-top: 20px;
                padding-top: 20px;
                border-top: 1px solid #ccc;
            }
        </style>
    </head>
    <body>

        <div id = "headerina">Noticias | Serviços | Contatos | Transparência </div>
        <div id="Tagline">
            <h1><p>MAPEIA+</p></h1>
            <h2><p>Sua nova maneira de interagir com o trânsito da cidade.</p></h2>
        </div>

        <div id="login">
            <form id="form-login">
                <h3>Acessar sua conta</h3>
                <label for="usuario-login"> <p> Usuário (Email): </p> </label>
                <input type="email" id="usuario-login" name="usuario-login" required><br>
                
                <label for="senha-login"> <p> Senha: </p></label>
                <input type="password" id="senha-login" name="senha-login" required><br>
                
                <button type="submit">Entrar</button>
                
                <p id="mensagem-login"></p>
            </form>
        </div>

        <div id="registro-form">
            <form id="form-registro">
                <h3>Não possui conta? Registre-se.</h3>
                
                <label for="nome-reg"> <p> Nome: </p> </label>
                <input type="text" id="nome-reg" name="nome-reg" required><br>
        
                <label for="email-reg"> <p> Email: </p> </label>
                <input type="email" id="email-reg" name="email-reg" required><br>
        
                <label for="senha-reg"> <p> Senha: </p></label>
                <input type="password" id="senha-reg" name="senha-reg" required><br>
                
                <button type="submit">Registrar</button>
                
                <p id="mensagem-registro"></p>
            </form>
        </div>

        <P>
            
        <div id = "parent act"><h1> Áreas de atuação</h1></div>
        <div id = "act1"><P> Sinalização</P></div>
        <div id="act2"><P> Asfaltamento</P></div>
        <div id="act3"><P> Fluxo de trânsito</P></div>

        <script>
            document.getElementById("form-login").addEventListener("submit", function(event) {
                event.preventDefault(); 

                const emailInput = document.getElementById("usuario-login");
                const senhaInput = document.getElementById("senha-login");
                const mensagem = document.getElementById("mensagem-login");

                const dadosLogin = {
                    email: emailInput.value,
                    senha: senhaInput.value
                };

                fetch('https://denunciaapi.onrender.com/api/usuarios/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(dadosLogin) 
                })
                .then(response => {
                    if (response.ok) {
                        return response.json(); 
                    } else {
                        throw new Error('Email ou senha incorretos.');
                    }
                })
                .then(usuarioLogado => {
                    localStorage.setItem('usuario_id', usuarioLogado.id);
                    localStorage.setItem('usuario_nome', usuarioLogado.nome);
                    window.location.href = 'denuncias.html'; 
                })
                .catch(error => {
                    mensagem.textContent = error.message;
                    mensagem.style.color = 'red';
                });
            });

            document.getElementById("form-registro").addEventListener("submit", function(event) {
                event.preventDefault(); 

                const nomeInput = document.getElementById("nome-reg");
                const emailInput = document.getElementById("email-reg");
                const senhaInput = document.getElementById("senha-reg");
                const mensagem = document.getElementById("mensagem-registro");

                const dadosUsuario = {
                    nome: nomeInput.value,
                    email: emailInput.value,
                    senha: senhaInput.value
                };

                fetch('https://denunciaapi.onrender.com/api/usuarios', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(dadosUsuario)
                })
                .then(response => {
                    if (response.ok) {
                        return response.json();
                    } else {
                        throw new Error('Erro ao cadastrar. Tente outro email.');
                    }
                })
                .then(usuarioCriado => {
                    mensagem.textContent = 'Usuário ' + usuarioCriado.nome + ' criado com sucesso! Faça o login.';
                    mensagem.style.color = 'green';
                    nomeInput.value = '';
                    emailInput.value = '';
                    senhaInput.value = '';
                    senhaInput.value = ''; // A user's repeated line in the original code, preserved.
                })
                .catch(error => {
                    mensagem.textContent = error.message;
                    mensagem.style.color = 'red';
                });
            });







        </script>
    </body>
</html>